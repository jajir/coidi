<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.3 at Jan 31, 2016 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Coidi - Integration - RP</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20160131" />
    <meta http-equiv="Content-Language" content="en" />
                                                    
<script type="text/javascript">var _gaq = _gaq || [];
		  _gaq.push(['_setAccount', 'UA-33730727-1']);
		  _gaq.push(['_trackPageview']);
		
		  (function() {
		    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		  })();</script>
                      
        </head>
  <body class="composite">
    <div id="banner">
                        <a href="http://coidi.sourceforge.net/" id="bannerLeft">
                                                <img src="./coidi-logo.png" alt="Coidi" />
                </a>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                    
                <div class="xleft">
                                  <a href="https://sourceforge.net/projects/coidi/" class="externalLink" title="Coidi at Souceforge">Coidi at Souceforge</a>
        &gt;
                          <a href="http://coidi.sourceforge.net/" class="externalLink" title="Documentation">Documentation</a>
        &gt;
    Integration - RP
      </div>
            <div class="xright">        
                    
                 <span id="publishDate">Last Published: 31 Jan 2016</span>
            </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                    
                                <h5>Coidi</h5>
                  <ul>
                  <li class="none">
                          <a href="./index.html" title="Index">Index</a>
            </li>
                  <li class="none">
                          <a href="./why-sso.html" title="Why SSO">Why SSO</a>
            </li>
                  <li class="none">
                          <a href="./how-to-start.html" title="How to start">How to start</a>
            </li>
                                                                                                                                                                                            <li class="expanded">
                          <a href="./openid.html" title="OpenID">OpenID</a>
                    <ul>
                      <li class="none">
                          <a href="./introduction.html" title="Introduction">Introduction</a>
            </li>
                      <li class="none">
                          <a href="./data-model.html" title="Data model">Data model</a>
            </li>
                      <li class="none">
                          <a href="./communication.html" title="Communication">Communication</a>
            </li>
                      <li class="none">
                          <a href="./identity.html" title="Identity">Identity</a>
            </li>
                      <li class="none">
                          <a href="./normalization.html" title="Normalization">Normalization</a>
            </li>
                      <li class="none">
                          <a href="./discovery.html" title="Discovery">Discovery</a>
            </li>
                      <li class="none">
                          <a href="./xrds.html" title="XRDS">XRDS</a>
            </li>
                      <li class="none">
                          <a href="./authentication.html" title="Authentication">Authentication</a>
            </li>
              </ul>
        </li>
                                                                                <li class="expanded">
                          <a href="./integration.html" title="How to integrate">How to integrate</a>
                    <ul>
                      <li class="none">
                          <a href="./integration-rp.html" title="Relying party">Relying party</a>
            </li>
                      <li class="none">
                          <a href="./integration-op.html" title="OpenID provider">OpenID provider</a>
            </li>
              </ul>
        </li>
                                                                                <li class="expanded">
                          <a href="./development.html" title="Development">Development</a>
                    <ul>
                      <li class="none">
                          <a href="./project.html" title="Project structure">Project structure</a>
            </li>
                      <li class="none">
                          <a href="./release.html" title="Release methodology">Release methodology</a>
            </li>
              </ul>
        </li>
                  <li class="none">
                          <a href="./abbreviations.html" title="Abbreviations">Abbreviations</a>
            </li>
          </ul>
                                                                                                                                     <a href="http://maven.apache.org/" title="Maven" class="poweredBy">
        <img class="poweredBy"  alt="Maven" src="./maven-feather.png"     />
      </a>
                                                                                                                      <a href="http://tapestry.apache.org/" title="Tapestry 5" class="poweredBy">
        <img class="poweredBy"  alt="Tapestry 5" src="./tapestry.png"     />
      </a>
                       
                    
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Integration - RP<a name="Integration_-_RP"></a></h2><div class="section"><h3>First steps<a name="First_steps"></a></h3><div class="section"><h4>Requirements<a name="Requirements"></a></h4><ul><li>Coidi RP could by integrated just with java web application. Java 1.6 or greater.</li></ul></div><div class="section"><h4>Integration steps<a name="Integration_steps"></a></h4><ol style="list-style-type: decimal"><li>Changes in UI (required) - you should add new form for for entering user's OpenId identificators.</li><li>Call OpenId relaying party functions</li><li>Persistent nonce store (optionally) - Nonces have to be stored for some limited time. In some cases nonces could hold just in application memory.</li><li>Scheduler (optionally) - All nonces are stored in nonce store. Nonce is valid just for limited time. When this time exceed than nonce could be removed. Deleting of stale nonces should be called periodically by some scheduler. </li></ol><p>Clustered deployment structure of OpenID relying part:</p><img src="appdeployment-rp-nonce.png" alt="RP with implemented nonce store " /><p>In most cases is scheduler in both nodes.</p></div></div><div class="section"><h3>Integration steps <a name="Integration_steps"></a></h3><div class="section"><h4>UI changes<a name="UI_changes"></a></h4><p>On Relaying party side have to be created new form for entering user'd identifiers. According to OpenId specification form field where user should enter his OpenID identification string should be called &quot;openid_identifier&quot;. Then just &quot;Submit&quot; button is required. After submitting user's identification should be passed to relaying party verification process. </p></div><div class="section"><h4>Call OpenId relaying party functions<a name="Call_OpenId_relaying_party_functions"></a></h4></div><div class="section"><h4>Persistent nonce store<a name="Persistent_nonce_store"></a></h4><p>As was mentioned nonces are unique string that verify that authentication was used just one time. When nonce come for first time to RP than is stored. Next time when it come whole message is rejected. Simply says it's just place where are nonces stored for some limited time (usually 30 minutes). When you run you application as single node that you can store nonces in memory. This approach allows use nonces more that once when your application is restarted. In that case you can use bundled in memory nonce store. You should consider if this security vulnerability is acceptable for your application.</p><p>When you run application with more that one node or you don't want accept risk of reusing nonce after application restart that you have to consider your persistent nonce store. You can create your own nonce store by implementing <i>com.coroptis.coidi.rp.services.NonceDao</i> interface from rp library.</p><p>When you expect big load of uses and authentication requests than you should take care of removing of old nonces.</p><p>Nonce store could be implemented with any technology, for example:</p><ul><li>Database - JPA </li><li>Shared cache memory - for example <a class="externalLink" href="http://memcached.org/">memcached</a></li><li>LDAP</li></ul><p>Coidi doesn't provide concrete implementation, because each application have it's special requirements for drivers, library that can't by fulfilled by coidi library.</p></div><div class="section"><h4>Scheduler<a name="Scheduler"></a></h4><p>When is used some kind of persistent store for nonces than this nonces after some time become stale. Stale nonces could be removed. Process of removing staled nonces could be run periodically by some scheduler. Scheduler should be part of production application. Coidi library scheduler doesn't support because scheduler is usually part of application server </p></div></div><div class="section"><h3>Integration od code<a name="Integration_od_code"></a></h3></div></div><div class="section"><h2>TODO add some examples<a name="TODO_add_some_examples"></a></h2></div><div class="section"><h2>configuration of normalization dicovery and authentication request creating.<a name="configuration_of_normalization_dicovery_and_authentication_request_creating."></a></h2></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              <?xml version="1.0" encoding="UTF-8"?>
<footer></footer>
            </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
